scale_shape_manual(values = c(21,22,23,24)) +
scale_shape_discrete(labels = function(x) parse(text = x),
name = NULL,
values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB")) +  # parse SNR labels
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB")) +
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"))
}
totMEANplotnoaxis <- function(TOT){
TOTm <- TOT |>
group_by(Method, SNR, Dimension) |>
summarise(mean = mean(MCC), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("MCC") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3) +  # hide colour legend
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
scale_shape_manual(values = c(21,22,23,24)) +
scale_shape_discrete(labels = function(x) parse(text = x),
name = NULL,
values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB")) +  # parse SNR labels
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"))
}
c1hardM = rbind(c11hard,c22hard) |> totMEANplotnoaxis()
c2hardM = rbind(c33hard,c44hard) |> totMEANplot()
c1hardM/c2hardM + plot_layout(guides = "collect", axis_titles = "collect")
totMEANplotnoaxis <- function(TOT){
TOTm <- TOT |>
group_by(Method, SNR, Dimension) |>
summarise(mean = mean(MCC), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("MCC") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3) +  # hide colour legend
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
scale_shape_manual(values = c(21,22,23,24)) +
scale_shape_discrete(labels = function(x) parse(text = x),
name = NULL,
values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB")) +  # parse SNR labels
# scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB")) +
# scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"))
}
totMEANplotnoaxis <- function(TOT){
TOTm <- TOT |>
group_by(Method, SNR, Dimension) |>
summarise(mean = mean(MCC), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("MCC") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3) +  # hide colour legend
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
scale_shape_manual(values = c(21,22,23,24)) +
scale_shape_discrete(labels = function(x) parse(text = x),
name = NULL,
values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"))  # parse SNR labels
# scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB")) +
# scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"))
}
c1hardM = rbind(c11hard,c22hard) |> totMEANplotnoaxis()
c2hardM = rbind(c33hard,c44hard) |> totMEANplot()
c1hardM/c2hardM + plot_layout(guides = "collect", axis_titles = "collect")
totplotNnoaxis = function(TOT, lim = max(TOT$NN)){
str = unique(TOT$Dimension) |> as.character() |> strsplit(split = "|")
active = numeric(length(str))
for (i in 1:length(str)){
if (str[[i]] |> last() == 0){
active[i] = paste(str[[i]] |> nth(-2), str[[i]] |> last(), sep = "") |> as.numeric()
}else{
active[i] = as.numeric(str[[i]] |> last())
}
}
TOTdummy = TOT |> group_by(Dimension) |> summarise(active = mean(NN))
TOTdummy$active = active
ggplot(TOT,aes(x = Method, y = NN, fill = Method)) + geom_boxplot(alpha = 0.65) +
facet_grid(Dimension ~SNR, labeller = label_parsed) +
ylab("Variables Selected") +
geom_hline(data = TOTdummy, aes(yintercept = active), linetype = "dashed", linewidth = 0.5) +
coord_cartesian(ylim = c(0, lim)) +
theme_few_grid(base_size = 20) +
stat_summary(fun ="mean", shape = 5, size = 0.5) +
stat_summary(fun= "mean", geom="line", linetype ="solid", linewidth = 0.5,  aes(group= cluster, alpha = 2)) +
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x= element_blank()) +
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"))
}
totMEANplotnoaxis <- function(TOT){
TOTm <- TOT |>
group_by(Method, SNR, Dimension) |>
summarise(mean = mean(MCC), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("MCC") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3) +  # hide colour legend
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
scale_shape_manual(values = c(21,22,23,24)) +
scale_linetype_discrete(labels = function(x) parse(text = x),
name = NULL) +  # parse SNR labels
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB")) +
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"))
}
totMEANplot = function(TOT, stat){
TOTm = TOT |> group_by(Method, SNR, Dimension) |> summarise(mean = mean(MCC))
ggplot(TOTm, aes(x = Method, y = mean, group = interaction(SNR))) +
geom_line(linetype = "dotted") +
ylab("MCC") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
xlab(element_blank()) +
scale_shape_manual(values = c(21,22,23,24)) +
scale_linetype_discrete(labels = function(x) parse(text = x),
name = NULL) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"))+
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"))
}
c1hardM = rbind(c11hard,c22hard) |> totMEANplotnoaxis()
c2hardM = rbind(c33hard,c44hard) |> totMEANplot()
c1hardM/c2hardM + plot_layout(guides = "collect", axis_titles = "collect")
TOTM
c11hard$SNR
totMEANplotnoaxis <- function(TOT){
TOTm <- TOT |>
group_by(Method, SNR, Dimension) |>
summarise(mean = mean(MCC), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("MCC") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = TRUE) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.title = element_blank()  # removes legend title
) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#8DA0CB"), guide = "none")  # hide fill legend
}
c1hardM = rbind(c11hard,c22hard) |> totMEANplotnoaxis()
c2hardM = rbind(c33hard,c44hard) |> totMEANplot()
c1hardM/c2hardM + plot_layout(guides = "collect", axis_titles = "collect")
totMEANplotnoaxis <- function(TOT){
TOTm <- TOT |>
group_by(Method, SNR, Dimension) |>
summarise(mean = mean(MCC), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("MCC") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = TRUE) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.title = element_blank()  # removes legend title
) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none")  # hide fill legend
}
c1hardM = rbind(c11hard,c22hard) |> totMEANplotnoaxis()
c2hardM = rbind(c33hard,c44hard) |> totMEANplot()
c1hardM/c2hardM + plot_layout(guides = "collect", axis_titles = "collect")
totMEANplotnoaxis <- function(TOT){
TOTm <- TOT |>
group_by(Method, SNR, Dimension) |>
summarise(mean = mean(MCC), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("MCC") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = TRUE) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.title = element_blank()  # removes legend title
) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none")  # hide fill legend
}
rbind(c11hard,c22hard) |> totMEANplotnoaxis()
totMEANplot = function(TOT, stat){
TOTm = TOT |> group_by(Method, SNR, Dimension) |> summarise(mean = mean(MCC))
ggplot(TOTm, aes(x = Method, y = mean, group = interaction(SNR))) +
geom_line(linetype = "dotted") +
ylab("MCC") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = T) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
xlab(element_blank()) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none")  # hide fill legend
}
c1hardM = rbind(c11hard,c22hard) |> totMEANplotnoaxis()
c2hardM = rbind(c33hard,c44hard) |> totMEANplot()
c1hardM/c2hardM + plot_layout(guides = "collect", axis_titles = "collect")
totMEANplot = function(TOT, stat){
TOTm = TOT |> group_by(Method, SNR, Dimension) |> summarise(mean = mean(MCC))
ggplot(TOTm, aes(x = Method, y = mean, group = interaction(SNR))) +
geom_line(linetype = "dotted") +
ylab("MCC") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = T) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
legend.title = element_blank()) +
xlab(element_blank()) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none")  # hide fill legend
}
c1hardM = rbind(c11hard,c22hard) |> totMEANplotnoaxis()
c2hardM = rbind(c33hard,c44hard) |> totMEANplot()
c1hardM/c2hardM + plot_layout(guides = "collect", axis_titles = "collect")
TOT = rbind(c11hard, c22hard)
TOT$NN
TOT
TOT = rbind(c11Nhard, c22Nhard)
TOT = rbind(c11Nhard, c22Nhard)
load("Data/S1.Rdata")
load("Data/S2.Rdata")
load("Data/S3.Rdata")
load("Data/S4.Rdata")
TOT = rbind(c11Nhard, c22Nhard)
#---#---#---#---#---#---#---#---#---#---#---#---#---#---
# Variables Selected
c11Nhard = combineN(S1.05hard, S1.1hard, S1.2hard, S1.3hard,  1, filtered = filtered) |> makeCluster()
c22Nhard = combineN(S2.05hard, S2.1hard, S2.2hard, S2.3hard,  2, filtered = filtered) |> makeCluster()
c33Nhard = combineN(S3.05hard, S3.1hard, S3.2hard, S3.3hard,  3, filtered = filtered) |> makeCluster()
c44Nhard = combineN(S4.05hard, S4.1hard, S4.2hard, S4.3hard,  4, filtered = filtered) |> makeCluster()
TOT = rbind(c11Nhard, c22Nhard)
str = unique(TOT$Dimension) |> as.character() |> strsplit(split = "|")
active = numeric(length(str))
for (i in 1:length(str)){
if (str[[i]] |> last() == 0){
active[i] = paste(str[[i]] |> nth(-2), str[[i]] |> last(), sep = "") |> as.numeric()
}else{
active[i] = as.numeric(str[[i]] |> last())
}
}
TOTdummy = TOT |> group_by(Dimension) |> summarise(active = mean(NN))
TOTdummy$active = active
TOTdummy
TOT
TOTm = TOT |> group_by(Method, SNR, Dimension) |>
summarise(mean = mean(NN), .groups = "drop")
TOTm
totMEANnplotnoaxis = function(TOT, lim = max(TOT$NN)){
str = unique(TOT$Dimension) |> as.character() |> strsplit(split = "|")
active = numeric(length(str))
for (i in 1:length(str)){
if (str[[i]] |> last() == 0){
active[i] = paste(str[[i]] |> nth(-2), str[[i]] |> last(), sep = "") |> as.numeric()
}else{
active[i] = as.numeric(str[[i]] |> last())
}
}
TOTdummy = TOT |> group_by(Dimension) |> summarise(active = mean(NN))
TOTdummy$active = active
TOTm = TOT |> group_by(Method, SNR, Dimension) |>
summarise(mean = mean(NN), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("Variables Selected") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = TRUE) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.title = element_blank()  # removes legend title
) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none")  # hide fill legend
}
c1nhardM = rbind(c11Nhard,c22Nhard) |> totMEANnplotNnoaxis(lim = 50)
totMEANnplotnoaxis = function(TOT, lim = max(TOT$NN)){
str = unique(TOT$Dimension) |> as.character() |> strsplit(split = "|")
active = numeric(length(str))
for (i in 1:length(str)){
if (str[[i]] |> last() == 0){
active[i] = paste(str[[i]] |> nth(-2), str[[i]] |> last(), sep = "") |> as.numeric()
}else{
active[i] = as.numeric(str[[i]] |> last())
}
}
TOTdummy = TOT |> group_by(Dimension) |> summarise(active = mean(NN))
TOTdummy$active = active
TOTm = TOT |> group_by(Method, SNR, Dimension) |>
summarise(mean = mean(NN), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("Variables Selected") +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = TRUE) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.title = element_blank()  # removes legend title
) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none")  # hide fill legend
}
c1nhardM = rbind(c11Nhard,c22Nhard) |> totMEANnplotnoaxis(lim = 50)
c1nhardM
totMEANnplotnoaxis = function(TOT, lim = max(TOT$NN)){
str = unique(TOT$Dimension) |> as.character() |> strsplit(split = "|")
active = numeric(length(str))
for (i in 1:length(str)){
if (str[[i]] |> last() == 0){
active[i] = paste(str[[i]] |> nth(-2), str[[i]] |> last(), sep = "") |> as.numeric()
}else{
active[i] = as.numeric(str[[i]] |> last())
}
}
TOTdummy = TOT |> group_by(Dimension) |> summarise(active = mean(NN))
TOTdummy$active = active
TOTm = TOT |> group_by(Method, SNR, Dimension) |>
summarise(mean = mean(NN), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("Variables Selected") +
geom_hline(data = TOTdummy, aes(yintercept = active), linetype = "dashed", linewidth = 0.5) +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = TRUE) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.title = element_blank()  # removes legend title
) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none")  # hide fill legend
}
c1nhardM
c1nhardM = rbind(c11Nhard,c22Nhard) |> totMEANnplotnoaxis(lim = 50)
c1nhardM
NtotMEANplot = function(TOT, lim = max(TOT$NN)){
str = unique(TOT$Dimension) |> as.character() |> strsplit(split = "|")
active = numeric(length(str))
for (i in 1:length(str)){
if (str[[i]] |> last() == 0){
active[i] = paste(str[[i]] |> nth(-2), str[[i]] |> last(), sep = "") |> as.numeric()
}else{
active[i] = as.numeric(str[[i]] |> last())
}
}
TOTdummy = TOT |> group_by(Dimension) |> summarise(active = mean(NN))
TOTdummy$active = active
TOTm = TOT |> group_by(Method, SNR, Dimension) |>
summarise(mean = mean(NN), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("Variables Selected") +
geom_hline(data = TOTdummy, aes(yintercept = active), linetype = "dashed", linewidth = 0.5) +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = TRUE) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
legend.title = element_blank()) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none")  # hide fill legend
}
c1hardM = rbind(c11hard,c22hard) |> NtotMEANplotnoaxis()
NtotMEANplotnoaxis = function(TOT, lim = max(TOT$NN)){
str = unique(TOT$Dimension) |> as.character() |> strsplit(split = "|")
active = numeric(length(str))
for (i in 1:length(str)){
if (str[[i]] |> last() == 0){
active[i] = paste(str[[i]] |> nth(-2), str[[i]] |> last(), sep = "") |> as.numeric()
}else{
active[i] = as.numeric(str[[i]] |> last())
}
}
TOTdummy = TOT |> group_by(Dimension) |> summarise(active = mean(NN))
TOTdummy$active = active
TOTm = TOT |> group_by(Method, SNR, Dimension) |>
summarise(mean = mean(NN), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("Variables Selected") +
geom_hline(data = TOTdummy, aes(yintercept = active), linetype = "dashed", linewidth = 0.5) +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = TRUE) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.title = element_blank()  # removes legend title
) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none")  # hide fill legend
}
c1hardM = rbind(c11hard,c22hard) |> NtotMEANplotnoaxis()
c2hardM = rbind(c33hard,c44hard) |> NtotMEANplot()
c1nhardM = rbind(c11Nhard,c22Nhard) |> NtotMEANplotnoaxis(lim = 50)
c2nhardM = rbind(c33Nhard,c44Nhard) |> NtotMEANplotN(lim = 60)
NtotMEANplot = function(TOT, lim = max(TOT$NN)){
str = unique(TOT$Dimension) |> as.character() |> strsplit(split = "|")
active = numeric(length(str))
for (i in 1:length(str)){
if (str[[i]] |> last() == 0){
active[i] = paste(str[[i]] |> nth(-2), str[[i]] |> last(), sep = "") |> as.numeric()
}else{
active[i] = as.numeric(str[[i]] |> last())
}
}
TOTdummy = TOT |> group_by(Dimension) |> summarise(active = mean(NN))
TOTdummy$active = active
TOTm = TOT |> group_by(Method, SNR, Dimension) |>
summarise(mean = mean(NN), .groups = "drop")
ggplot(TOTm, aes(x = Method, y = mean, group = SNR)) +
geom_line(linetype = "dotted") +
ylab("Variables Selected") +
geom_hline(data = TOTdummy, aes(yintercept = active), linetype = "dashed", linewidth = 0.5) +
geom_point(aes(colour = Method, shape = SNR, fill = Method), size = 3, show.legend = TRUE) +
facet_grid(~Dimension, labeller = label_parsed) +
theme_few_grid(base_size = 20) +
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
legend.title = element_blank()) +
scale_shape_manual(
values = c(21,22,23,24),
labels = parse(text = c("SNR==0.5", "SNR==1", "SNR==2", "SNR==3"))  # parsed SNR labels
) +
scale_colour_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none") +  # hide colour legend
scale_fill_manual(values = c("#FC8D62", "#FFD92F","#A6D854","#A6D854","#A6D854","#8DA0CB","#8DA0CB","#8DA0CB"), guide = "none")  # hide fill legend
}
c2nhardM = rbind(c33Nhard,c44Nhard) |> NtotMEANplotN(lim = 60)
c2nhardM = rbind(c33Nhard,c44Nhard) |> NtotMEANplot(lim = 60)
c1nhardM/c2nhardM
c1nhardM/c2nhardM + plot_layout(guides = "collect", axis_titles = "collect")
c1hardM/c2hardM + plot_layout(guides = "collect", axis_titles = "collect")
c1nhardM/c2nhardM + plot_layout(guides = "collect", axis_titles = "collect")
